CMAKE_MINIMUM_REQUIRED(VERSION 3.20...3.31)

IF(WIN32)
  MESSAGE(WARNING "Your host is not UNIX")
ENDIF()

PROJECT(misc
  DESCRIPTION "Miscellanous library for C"
  HOMEPAGE_URL "https://github.com/Yuuki1578/misc"
  VERSION 0.1.0
  LANGUAGES C
)

SET(MISC_STATIC_LIBRARY "static-misc")
SET(MISC_SOURCE_DIR "./src")
SET(MISC_INCLUDE_DIR "./include")

SET(MISC_TEST_EXE "test")
SET(MISC_TEST_DIR "./test")
SET(MISC_TEST_FILE "${MISC_TEST_DIR}/test.c")

SET(CMAKE_C_STANDARD 23)
SET(CMAKE_C_STANDARD_REQUIRED TRUE)
SET(CMAKE_EXPORT_COMPILE_COMMANDS ON)

FILE(GLOB MISC_SOURCE_FILES "${MISC_SOURCE_DIR}/*.c")
INCLUDE_DIRECTORIES(${MISC_INCLUDE_DIR})

# Debugging
ADD_LINK_OPTIONS(
  -fsanitize=address
)

ADD_LIBRARY(${PROJECT_NAME}
  SHARED
  ${MISC_SOURCE_FILES}
)

ADD_LIBRARY(${MISC_STATIC_LIBRARY}
  STATIC
  ${MISC_SOURCE_FILES}
)

ADD_EXECUTABLE(${MISC_TEST_EXE}
  ${MISC_TEST_FILE}
  ${MISC_SOURCE_FILES}
)
